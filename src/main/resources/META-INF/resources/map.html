<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map</title>

    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/patternfly/3.24.0/css/patternfly.min.css">
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/patternfly/3.24.0/css/patternfly-additions.min.css">
    <style>
        table {
          font-family: arial, sans-serif;
          border-collapse: collapse;
        }

        td {
          border: 1px solid #dddddd;
          text-align: left;
          padding: 8px;
        }



    </style>
</head>
<body>
<div class="container">

    <h2>Worms</h2>
    <div class="row" id="content">
        <table></table>
    </div>
</div>
</body>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    var source = new EventSource("/v1/match/2/map");
    source.onmessage = function (event) {
        var map = JSON.parse(event.data);
        document.getElementById("content").removeChild(document.getElementById("content").childNodes[0]);
        var table = document.createElement("table");
        for(var y = map.mapSize - 1; y >= 0; y--) {
            var tr = document.createElement("tr");
            for(var x = 0; x < map.mapSize; x++) {
                var td = document.createElement("td");
                td.setAttribute("id", x + "_" + y);
                td.innerHtml = "&nbsp;";
                tr.appendChild(td);
            }
            table.appendChild(tr);
        }
        document.getElementById("content").appendChild(table);

        document.getElementById(map.foodPosition.x + "_" + map.foodPosition.y).innerHtml = "o";

        for(var playerIndex = 0; playerIndex < map.players.length; playerIndex++) {
            var player = map.players[playerIndex];
            if(player.status == "PLAYING") {
                for(var positionIndex = 0; positionIndex < player.position.length; positionIndex++) {
                    var point = player.position[positionIndex];
                    document.getElementById(point.x + "_" + point.y).innerHtml = "x";
                }
            }
        }
    };



</script>
</html>